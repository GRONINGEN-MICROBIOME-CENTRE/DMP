## DMP microbiome variance analysis (Fig 3/C)

The folder contains scripts used to calculate microbiome variance explained by phenotypes and groups of phentypes (Fig 3/C). 

### Dependencies:
- R packages ggplot2, coin, vegan, pheatmap, viridis. Running *install.packages(c("ggplot2","coin","vegan","pheatmap","viridis"))* is usually enough to install these. 
- variance explained plots (generated by DMP_variance_explained_plots_Fig3C.R) requre DMP phenotype grouping file (included in this repo: microbiome_variance/group_adonis/*groups_v2.csv*) and results of DMP adonis analysis (included in this repo in *microbiome_variance/group_adonis/output_adonis_multivariate* folder)

### Notes:
- Re-producing DMP result Fig. 3/c requires running of codes supplied here on microbiome data avaliable at EGA and phenotype data that has to be requested through Lifelines biobank to protect the privacy of study participants (see manuscript for details). To facilitate testing and re-use of these codes, this repo includes implementation of the analysis on *mock data* for demonstration purposes. We also provide summary statistics produced by running these codes on full dataset, script *DMP_variance_explained_plots_Fig3C.R* uses the summary statistics to re-produced DMP Fig. 3/c.

### Files:
- *group_adonis* : folder with input files for multivariate adonis plots and output of the script
- *mockdata_output_adonis* : folder with expected results of running codes on mock data
- DMP_variance_explained_plots_Fig3C.R : script for plotting results of multivariate adonis analysis (Figure 3/C). 
- Mockdata_DMP_adonis_pwys.R : implementation of analysis of microbiome functional pathways variance explained by phenotypes on the mock data
- Mockdata_DMP_adonis_taxa.R : implementation of analysis of microbiome taxonomy variance explained by phenotypes on the mock data
- R_sessionInfo.txt : writedown of R environment used for the analysis